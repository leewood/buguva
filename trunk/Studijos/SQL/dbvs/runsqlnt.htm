<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1257">
<TITLE>SQL sakiniø atlikimas</TITLE>
</HEAD>
<BODY BGCOLOR="#eeffbb">

<H3>
<P ALIGN="CENTER">SQL sakiniø atlikimas Windows ir LINUX terpëse</P>
</H3>

SQL sakinius galima vykdyti:
<OL>
<LI>Nurodant sakinius <a href="#explicit">betarpiðkai</a> vykdymo instrukcijoje;</LI>
<LI>Nurodant sakinius <a href="#implicit">failo vardu</a>.</LI>
</OL>
<hr>

<H3>
<a name="explicit">
<P ALIGN="CENTER">Betarpiðkas sakiniø atlikimas</P>
</H3>

<P>
SQL sakinius galima atlikti juos betarpiðkai uþraðius
<OL>
<LI><a href="#cmdproc">DB2 komandø procesoriaus</a> (<i>DB2 Command Processor</i>) lange
<LI><a href="#cmdwindow">komandø lange</a>,
prieð tai <a href="#cmdinit">inicializavus DB2 terpæ</a> (<i>DB2 Command Window</i>).
</OL>

<H4>
<a name="cmdproc">
<P ALIGN="LEFT">Sakiniø atlikimas DB2 komandø procesoriumi</P>
</H4>
DB2 komandø procesorius iðkvieèiamas ið meniu <i>"DB2 Command Processor"</i> arba
ávykdþius vykdomàjá failà <tt>db2</tt>,
prieð tai <a href="#cmdinit">inicializavus DB2 terpæ</a>.
<p>
Startavus DB2 komandø procesoriø, ekrane pavaizduojamas kvietimas SQL
sakiniui ávesti: <tt>db2 =></tt> <br>
SQL sakinys ávedamas klaviatûra ir, paspaudus
klaviðà <tt>Enter</tt>, jis pradedamas vykdyti.
Uþklausos rezultatas pavaizduojamas ekrane. Pavyzdþiui, ávykdþius
<PRE>
db2=> SELECT * FROM stud.knyga
</PRE>
lange bus pavaizduotos visos lentelës <i>stud.knyga</i> eilutës.<br>
DB2 komandø procesoriaus darbas uþbaigiamas komanda <tt>quit</tt>:
<PRE>
db2 => quit
</PRE>
Po komandos <tt>quit</tt> operacinës sistemos langas neuþsidaro.
Jis tampa áprastu sistemos komandiniu langu.
Kadangi startuojant DB2 komandø procesoriø atliekama DB2 terpës inicializacija,
tai langas turi visas <a href="#cmdwindow"> DB2 komandø lango </a>savybes.

<H4>
<a name="cmdinit">
<P ALIGN="LEFT">DB2 terpës inicializacija</P>
</H4>
DB2 komandø (SQL sakiniø) terpë (langas) inicializuojama iðrinkus ið DB2 meniu
    <i>"DB2 Command Window"</i> arba komandø eilutëje ávykdant specialø vykdomàjá failà:
<OL>
<LI> <b>Windows</b> terpëje: <b><tt>db2wnd.exe</tt></b>.
<LI> <b>LINUX</b> terpëje: <b><tt>db2env</tt></b>.
</OL>

<H4>
<a name="cmdwindow">
<P ALIGN="LEFT">Sakiniø atlikimas DB2 komandø lange</P>
</H4>
Dirbant DB2 komandø lange, prieð SQL sakiná bûtina nurodyti prefiksa <tt>DB2</tt>,
kuriuo operacinei sistemai nurodoma ávykdyti komandà (programà) <tt>DB2</tt>, pvz.
<PRE>
db2 SELECT * FROM stud.knyga
</PRE>
Po prefikso einantis SQL sakinys yra parametras programai <tt>DB2</tt> (SQL komandø procesoriui).
Kaip ir bet kurá kità parametrà programai, SQL sakiná galima apskliasti kabutemis:
<PRE>
db2 "SELECT * FROM stud.knyga"
</PRE>
DB2 komandø lange, galima vykdyti ne tik SQL sakinius bet ir bet
kurias kitas komandas ar programas. Pavyzdþiui, DB2 komandø lange startavus
<tt>FAR.EXE</tt>, bus galima vykdyti ne tik SQL sakinius, bet ir patogiai atlikti
veiksmus su failais. <br>
DB2 komandø lange, ávykdþius komandà <tt>DB2</tt> be parametrø, startuoja
<a href="#cmdproc">DB2 komandø procesorius</a>.<br>
DB2 komandu langas - tai áprastas operacinës sistemos komandø langas,
kurá atidarant, papildomai inicializuojama DB2 terpë.
DB2 komandø langas uþdaromas, kaip paprastas operacinës sistemos langas.
<P>
<hr>

<H3>
<a name="implicit">
<P ALIGN="CENTER">Sakiniø, esanèiø faile, atlikimas</P>
</H3>

Papraðèiausias <i>DB2 Command Processor</i> komandinës eilutës pavidalas yra
<PRE>
db2 &lt;SQL sakinys&gt;
</PRE>
DB2 komandu procesorius (DB2 Command Processor) turi keleta parametru (<i>options</i>),
kurie leidþia SQL sakiná nurodyti ne betarpiðkai komandinëje
eilutëje, bet failo, kuriame yra SQL sakinys, vardu.
Tuomet SQL sakiniui ávesti galima pasitelkti bet koká tekstø redaktoriø, pvz. tà,
kuris vartojamas programoje FAR ar MC.
Tai patogu, kai uþklausos yra vykdomos kelis darbo seansus (uþsiëmimu),
nes ji gali bûti iðsaugota faile.

Jei SQL sakinys yra faile, reikia naudoti komandà:
<PRE>
db2 -f&lt;failo vardas&gt;
</PRE>
èia &lt;failo vardas&gt; yra su keliu (pilnas failo vardas) arba be jo.
Jei failas nurodytas be kelio, tai sistema ieðko failo einamajame kataloge.<br>
Pavyzdþiui, jei SQL sakinys yra faile <a href="select1.sql">select1.sql</a>,
esanèiame einamajame kataloge, tai vykdome:
<PRE>
db2 -fselect1.sql
</PRE>

Sistema uþklausos rezultatà pavaizduoja vaizduoklio ekrane.<br>
Norint, papildomai, gauti rezultatà faile, pvz. <a href="select1.res">select1.res</a>,
reikia nurodyti jo vardà komandinëje eilutëje:
<PRE>
db2 -fselect1.sql -rselect1.res
</PRE>
Taip vykdant SQL sakiná, jis tekstiniame faile turi bûti iðdëstytas vienoje eilutëje.
Norint SQL sakiná faile uþraðyti keliose eilutëse, reikalingas
papildomas parametras, kuriuo praneðama DB2 komandø procesoriui apie sakinio pabaigos poþymá.
DB2 komandø procesoriui perdavus parametrà -t, SQL sakinio gale bûtina raðyti kabliataðká.
Tuomet faile gali bûti ir keli SQL sakiniai, po kiekvieno raðant kabliataðká.
Komandos pavidalas, kai nurodoma, kad SQL sakiniai file baigiasi kabliataðkiu:
<PRE>
db2 -t -f&lt;failo vardas&gt; -r&lt;rezultato failo vardas&gt;
</PRE>
Po pasirinkèiø -f ir -r, prieð failo vardà galima palikti po tarpà.<br>
Kad ávykdyti SQL sakinius esanèius faile <a href="select2.sql">select2.sql</a> ir
rezultatà uþraðyti faile <a href="select2.res">select2.res</a>, reikia atlikti komandà:
<PRE>
db2 -t -fselect2.sql -rselect2.res
</PRE>
arba
<PRE>
db2 -t -f select2.sql -r select2.res
</PRE>
<P>
Kartais, pvz., kuriant trigerius, kai SQL sakinio dalimi yra kiti SQL sakiniai,
kabliataðkis negali bûti vartojamas viso SQL sakinio pabaigai þymëti.
Tuomet, vietoje parametro -t reikia naudoti -td<simbolis>, kuriuo
atskyrëju paskelbiamas kitas pasirinktas simbolis.
Esantys faile <a href="select3.sql">select3.sql</a> SQL sakiniai gali bûti atlikti ir
rezultatas uþraðytas faile <a href="select3.res">select3.res</a> iðkvietus komandø procesoriø taip:
<PRE>
db2 -td# -fselect3.sql -rselect3.res
</PRE>
<P>
Papildomos pastabos apie SQL sakiniø, esanèiø faile, atlikimà:
<UL>
<LI> bûtina naudoti <i>DB2 Command Window</i>, bet ne <i>DB2 Command line processor</i>; </LI>
<LI> nurodytas komandoje failas su <tt>SELECT</tt> sakiniu turi bûti pasiekiamas komandø procesoriui,
     t.y. reikia nurodyti pilnà failo vardà (su keliu) arba tas failas turi bûti
     einamajame kataloge;</LI>
<LI> kad sistema galëtø sukurti rezultato failà, pasirinktasis katalogas turi bûti prieinamas raðymui;
<LI> nepamirskite pradzioje prisijungti prie DB:
  <PRE>db2 connect to biblio user stud using stud</PRE>
  Darbà uþbaikite atsijungdami nuo DB:
  <PRE>db2 connect reset</PRE>
  Ðiuos sakinius taip pat galima patalpinti komandø (pvz., BAT, CMD) faile,
  pvz. <a href="sqlfile.cmd">sqlfile.cmd</a>, taèiau tai nebus efektyvu,
  nes <tt>CONNECT</tt> sakinys paprastai atliekamas þymiai lëèiau negu pats <tt>SELECT</tt> sakinys;</LI>
<LI>plaèiau SQL sakiniø atlikimà galima paskaityti elektroninëje knygoje <i>DB2 Command Reference</i>.</LI>
</UL>
<hr>
Dëst. A. Kurtinaièio <a href="http://uosis.mif.vu.lt/~andrius/dbvs/uzduot-1/pirmos-pratybos.html">patarimai pirmosioms pratyboms</a>.
<hr>
R.Baronas
</BODY>
</HTML>
